# **数据结构强化练习**

## “数组”的应用

### 对称矩阵的压缩存储

#### 1.1.1-6 对称阵推导

```shell
1 2 3 4 5
2 6 7 8 9
3 7 8 7 6 
4 8 7 5 4 
5 9 6 4 3

行优先: 1 / 2 6 / 3 7 8 / 4 8 7 5 / 5 9 6 4 3
列优先: 1 2 3 4 5 / 6 7 8 9 / 8 7 6 / 5 4 / 3
```

##### 行优先

**1-based**：对于 $a_{ij}$

* $i \ge j$ 时，设其对应一维数组下标为 $idx$（按王道书上定义，$idx$ 为 **0-based**）。显然 $a_{ij}$ 上方有 $i - 1$ 行，共有 $1 + 2 + \dots + (i - 1) = \cfrac{i(i - 1)}{2}$ 个元素，于是加上列偏移后 $idx = \cfrac{i(i - 1)}{2} + j - 1$
* $i \lt j$ 时，由于 $a_{ij} = a_{ji}$，故具有轮换对称性，即 $idx = \cfrac{j(j - 1)}{2} + i - 1$

**0-base**：令 $I = i - 1$，$J = j - 1$，则
$$
idx = \begin{cases}
\cfrac{(I + 1)I}{2} + J & I \ge J \\ 
\cfrac{(J + 1)J}{2} + I & I \lt J
\end{cases}
$$

##### 列优先

**1-based**：对于 $a_{ij}$

* $i \ge j$ 时，同理 $a_{ij}$ 前面有 $j - 1$ 列，共 $n + (n - 1) + \dots + (n - j + 2) = \cfrac{(2n - j + 2)(j - 1)}{2}$，从列首 $a_{jj}$ 开始计数，行偏移为 $i - j$，加上行偏移后 $idx = \cfrac{(2n - j + 2)(j - 1)}{2} + i - j$
* $i \lt j$ 时，由于 $a_{ij} = a_{ji}$，故具有轮换对称性，即 $idx = \cfrac{(2n - i + 2)(i - 1)}{2} + j - i$

**0-based**：令 $I = i - 1$，$J = j - 1$，则
$$
idx = \begin{cases}
\cfrac{(2n - J + 1)J}{2} + I - J & I \ge J \\ 
\cfrac{(2n - I + 1)I}{2} + J - I & I \lt J
\end{cases}
$$

#### 1.2.1-5 下三角矩阵推导

下三角矩阵跟对称阵 $i \ge j$ 的情况一致，$i \lt j$ 时为常量

#### 1.3.1-5 三对角矩阵推导

```shell
1 2 0 0 0
2 2 3 0 0
0 3 3 4 0
0 0 4 4 5
0 0 0 5 5 

行优先: 1 2 / 2 2 3 / 3 3 4 / 4 4 5 / 5 5
列优先: 1 2 / 2 2 3 / 3 3 4 / 4 4 5 / 5 5
```

##### 行优先

**1-based**：对于 $a_{ij}$

* $i \ne 1$ 时，前 $i - 1$ 行共有 $2 + 3(i - 2)$ 个元素，行偏移为 $j - i + 1$，则 $idx = 2 + 3(i - 2) + j - i + 1 = 2i + j - 3$
* $i = 1$ 时，显然 $idx = j - 1$
* 综上 $idx = 2i + j - 3$

##### 列优先

具有轮换对称性，即 $idx = 2j + i - 3$

